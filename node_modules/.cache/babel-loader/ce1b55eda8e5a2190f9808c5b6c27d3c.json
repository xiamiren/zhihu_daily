{"remainingRequest":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\src\\pages\\Login.vue?vue&type=template&id=15717af5&scoped=true","dependencies":[{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\src\\pages\\Login.vue","mtime":1658239034690},{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\babel.config.js","mtime":1658239012002},{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1658554939499},{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\babel-loader\\lib\\index.js","mtime":1658554870645},{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1658554972315},{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1658554939499},{"path":"C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1658554910597}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVzb2x2ZUNvbXBvbmVudCBhcyBfcmVzb2x2ZUNvbXBvbmVudCwgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCB0b0Rpc3BsYXlTdHJpbmcgYXMgX3RvRGlzcGxheVN0cmluZywgY3JlYXRlVGV4dFZOb2RlIGFzIF9jcmVhdGVUZXh0Vk5vZGUsIHdpdGhDdHggYXMgX3dpdGhDdHgsIGNyZWF0ZUVsZW1lbnRWTm9kZSBhcyBfY3JlYXRlRWxlbWVudFZOb2RlLCBGcmFnbWVudCBhcyBfRnJhZ21lbnQsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVFbGVtZW50QmxvY2sgYXMgX2NyZWF0ZUVsZW1lbnRCbG9jaywgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCnZhciBfd2l0aFNjb3BlSWQgPSBmdW5jdGlvbiBfd2l0aFNjb3BlSWQobikgewogIHJldHVybiBfcHVzaFNjb3BlSWQoImRhdGEtdi0xNTcxN2FmNSIpLCBuID0gbigpLCBfcG9wU2NvcGVJZCgpLCBuOwp9OwoKdmFyIF9ob2lzdGVkXzEgPSB7CiAgc3R5bGU6IHsKICAgICJtYXJnaW4iOiAiMjBweCA0MHB4IgogIH0KfTsKCnZhciBfaG9pc3RlZF8yID0gLyojX19QVVJFX18qL19jcmVhdGVUZXh0Vk5vZGUoIiDnq4vljbPnmbvlvZUv5rOo5YaMICIpOwoKZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICB2YXIgX2NvbXBvbmVudF9OYXYgPSBfcmVzb2x2ZUNvbXBvbmVudCgiTmF2Iik7CgogIHZhciBfY29tcG9uZW50X3Zhbl9idXR0b24gPSBfcmVzb2x2ZUNvbXBvbmVudCgidmFuLWJ1dHRvbiIpOwoKICB2YXIgX2NvbXBvbmVudF92YW5fZmllbGQgPSBfcmVzb2x2ZUNvbXBvbmVudCgidmFuLWZpZWxkIik7CgogIHZhciBfY29tcG9uZW50X3Zhbl9jZWxsX2dyb3VwID0gX3Jlc29sdmVDb21wb25lbnQoInZhbi1jZWxsLWdyb3VwIik7CgogIHZhciBfY29tcG9uZW50X3Zhbl9mb3JtID0gX3Jlc29sdmVDb21wb25lbnQoInZhbi1mb3JtIik7CgogIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soX0ZyYWdtZW50LCBudWxsLCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfTmF2KSwgX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfdmFuX2Zvcm0sIHsKICAgIHJlZjogImZvcm1Cb3giLAogICAgb25TdWJtaXQ6ICRzZXR1cC5zdWJtaXQKICB9LCB7CiAgICBkZWZhdWx0OiBfd2l0aEN0eChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfdmFuX2NlbGxfZ3JvdXAsIHsKICAgICAgICBpbnNldDogIiIKICAgICAgfSwgewogICAgICAgIGRlZmF1bHQ6IF93aXRoQ3R4KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfdmFuX2ZpZWxkLCB7CiAgICAgICAgICAgIG1vZGVsVmFsdWU6IF9jdHgucGhvbmUsCiAgICAgICAgICAgICJvblVwZGF0ZTptb2RlbFZhbHVlIjogX2NhY2hlWzBdIHx8IChfY2FjaGVbMF0gPSBmdW5jdGlvbiAoJGV2ZW50KSB7CiAgICAgICAgICAgICAgcmV0dXJuIF9jdHgucGhvbmUgPSAkZXZlbnQ7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBjZW50ZXI6ICIiLAogICAgICAgICAgICBsYWJlbDogIuaJi+acuuWPtyIsCiAgICAgICAgICAgICJsYWJlbC13aWR0aCI6ICI1MHB4IiwKICAgICAgICAgICAgbmFtZTogInBob25lIiwKICAgICAgICAgICAgcnVsZXM6IFt7CiAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+aJi+acuuWPt+S4uuW/heWhq+mhueWTpn4nCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBwYXR0ZXJuOiAkc2V0dXAucmVnUGhvbmUsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+aJi+acuuWPt+agvOW8j+S4jeWvueWTpn4nCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGJ1dHRvbjogX3dpdGhDdHgoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfdmFuX2J1dHRvbiwgewogICAgICAgICAgICAgICAgc2l6ZTogInNtYWxsIiwKICAgICAgICAgICAgICAgIHR5cGU6IF9jdHguZW5hYmxlID8gJ3ByaW1hcnknIDogJycsCiAgICAgICAgICAgICAgICBjbGFzczogImZvcm0tYnRuIiwKICAgICAgICAgICAgICAgIGRpc2FibGVkOiAhX2N0eC5lbmFibGUsCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAkc2V0dXAuc2VuZGNvZGUKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBkZWZhdWx0OiBfd2l0aEN0eChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBbX2NyZWF0ZVRleHRWTm9kZShfdG9EaXNwbGF5U3RyaW5nKF9jdHguZW5hYmxlID8gIuWPkemAgemqjOivgeeggSIgOiBfY3R4LnRpbWUpLCAxCiAgICAgICAgICAgICAgICAgIC8qIFRFWFQgKi8KICAgICAgICAgICAgICAgICAgKV07CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIF86IDEKICAgICAgICAgICAgICAgIC8qIFNUQUJMRSAqLwoKICAgICAgICAgICAgICB9LCA4CiAgICAgICAgICAgICAgLyogUFJPUFMgKi8KICAgICAgICAgICAgICAsIFsidHlwZSIsICJkaXNhYmxlZCIsICJvbkNsaWNrIl0pXTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIF86IDEKICAgICAgICAgICAgLyogU1RBQkxFICovCgogICAgICAgICAgfSwgOAogICAgICAgICAgLyogUFJPUFMgKi8KICAgICAgICAgICwgWyJtb2RlbFZhbHVlIiwgInJ1bGVzIl0pLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF92YW5fZmllbGQsIHsKICAgICAgICAgICAgbW9kZWxWYWx1ZTogX2N0eC5jb2RlLAogICAgICAgICAgICAib25VcGRhdGU6bW9kZWxWYWx1ZSI6IF9jYWNoZVsxXSB8fCAoX2NhY2hlWzFdID0gZnVuY3Rpb24gKCRldmVudCkgewogICAgICAgICAgICAgIHJldHVybiBfY3R4LmNvZGUgPSAkZXZlbnQ7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBsYWJlbDogIumqjOivgeeggSIsCiAgICAgICAgICAgICJsYWJlbC13aWR0aCI6ICI1MHB4IiwKICAgICAgICAgICAgcnVsZXM6IFt7CiAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+mqjOivgeeggeS4uuW/heWhq+mhueWTpn4nCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBwYXR0ZXJuOiAkc2V0dXAucmVnQ29kZSwKICAgICAgICAgICAgICBtZXNzYWdlOiAn6aqM6K+B56CB5b+F6aG75pivNuS9jeaVsOWtl+WTpn4nCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9LCBudWxsLCA4CiAgICAgICAgICAvKiBQUk9QUyAqLwogICAgICAgICAgLCBbIm1vZGVsVmFsdWUiLCAicnVsZXMiXSldOwogICAgICAgIH0pLAogICAgICAgIF86IDEKICAgICAgICAvKiBTVEFCTEUgKi8KCiAgICAgIH0pLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfdmFuX2J1dHRvbiwgewogICAgICAgIHJvdW5kOiAiIiwKICAgICAgICBibG9jazogIiIsCiAgICAgICAgdHlwZTogInByaW1hcnkiLAogICAgICAgICJuYXRpdmUtdHlwZSI6ICJzdWJtaXQiCiAgICAgIH0sIHsKICAgICAgICBkZWZhdWx0OiBfd2l0aEN0eChmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW19ob2lzdGVkXzJdOwogICAgICAgIH0pLAogICAgICAgIF86IDEKICAgICAgICAvKiBTVEFCTEUgKi8KCiAgICAgIH0pXSldOwogICAgfSksCiAgICBfOiAxCiAgICAvKiBTVEFCTEUgKi8KCiAgfSwgOAogIC8qIFBST1BTICovCiAgLCBbIm9uU3VibWl0Il0pXSwgNjQKICAvKiBTVEFCTEVfRlJBR01FTlQgKi8KICApOwp9"},{"version":3,"sources":["C:\\Users\\James\\Desktop\\kejian\\vue3知乎日报\\zhihu\\src\\pages\\Login.vue"],"names":[],"mappings":";;;;;;;AAuCS,EAAA,KAAyB,EAAzB;AAAA,cAAA;AAAA;;;+CACyD,W;;;;;;;;;;;;;6DAvChE,YAAA,CAAO,cAAP,C,EACA,YAAA,CA0CW,mBA1CX,EA0CW;AA1CD,IAAA,GAAG,EAAC,SA0CH;AA1Cc,IAAA,QAAM,EAAE,MAAA,CAAA;AA0CtB,GA1CX,E;sBACE;AAAA,aAkCiB,CAlCjB,YAAA,CAkCiB,yBAlCjB,EAkCiB;AAlCD,QAAA,KAAK,EAAL;AAkCC,OAlCjB,EAAqB;0BACnB;AAAA,iBAsBY,CAtBZ,YAAA,CAsBY,oBAtBZ,EAsBY;wBArBD,IAAA,CAAA,KAqBC;;qBArBD,IAAA,CAAA,K,GAAK,M;cAqBJ;AApBV,YAAA,MAAM,EAAN,EAoBU;AAnBV,YAAA,KAAK,EAAC,KAmBI;AAlBV,2BAAY,MAkBF;AAjBV,YAAA,IAAI,EAAC,OAiBK;AAhBT,YAAA,KAAK,EAAA,C;;;aAAA,E;uBAA6E,MAAA,CAAA,Q;AAAQ,cAAA,OAAA,EAAA;aAArF;AAgBI,WAtBZ,E;AAWa,YAAA,MAAM,EAAA,QAAA,CACf;AAAA,qBAQa,CARb,YAAA,CAQa,qBARb,EAQa;AAPX,gBAAA,IAAI,EAAC,OAOM;AANV,gBAAA,IAAI,EAAE,IAAA,CAAA,MAAA,GAAM,SAAN,GAAM,EAMF;AALX,gBAAA,KAAK,EAAC,UAKK;AAJV,gBAAA,QAAQ,EAAA,CAAG,IAAA,CAAA,MAID;AAHV,gBAAA,OAAK,EAAE,MAAA,CAAA;AAGG,eARb,E;kCAOE;AAAA,yBAA6B,C,kCAA1B,IAAA,CAAA,MAAA,GAAM,OAAN,GAAmB,IAAA,CAAA,I,GAAI;AAAA;mBAAG,CAA7B;AAAA,iB;;;;eAPF,E;;AAAA,gB,+BAAA,CAQa,CARb;AAAA,aADe,C;;;;WAXnB,E;;AAAA,Y,uBAAA,CAsBY,EAEZ,YAAA,CAQE,oBARF,EAQE;wBAPS,IAAA,CAAA,IAOT;;qBAPS,IAAA,CAAA,I,GAAI,M;cAOb;AANA,YAAA,KAAK,EAAC,KAMN;AALA,2BAAY,MAKZ;AAJC,YAAA,KAAK,EAAA,C;;;aAAA,E;uBAA6E,MAAA,CAAA,O;AAAO,cAAA,OAAA,EAAA;aAApF;AAIN,WARF,E,IAAA,E;;AAAA,Y,uBAAA,CAFY,CAtBZ;AAAA,S,CADmB;;;;AAAA,OAArB,CAkCiB,EAEjB,mBAAA,CAIM,KAJN,EAAA,UAAA,EAIM,CAHJ,YAAA,CAEa,qBAFb,EAEa;AAFD,QAAA,KAAK,EAAL,EAEC;AAFK,QAAA,KAAK,EAAL,EAEL;AAFW,QAAA,IAAI,EAAC,SAEhB;AAF0B,uBAAY;AAEtC,OAFb,E;0BAA4D;AAAA,iBAE5D,C,UAAA,CAF4D;AAAA,S;;;;OAA5D,CAGI,CAJN,CAFiB,CAlCjB;AAAA,K;;;;GADF,E;;AAAA,I,YAAA,C","sourcesContent":["<template>\n  <Nav />\n  <van-form ref=\"formBox\" @submit=\"submit\">\n    <van-cell-group inset>\n      <van-field\n        v-model=\"phone\"\n        center\n        label=\"手机号\"\n        label-width=\"50px\"\n        name=\"phone\"\n        :rules=\"[\n          { required: true, message: '手机号为必填项哦~' },\n          { pattern: regPhone, message: '手机号格式不对哦~' },\n        ]\"\n      >\n        <template #button>\n          <van-button\n            size=\"small\"\n            :type=\"enable ? 'primary' : ''\"\n            class=\"form-btn\"\n            :disabled=\"!enable\"\n            @click=\"sendcode\"\n          >\n            {{ enable ? \"发送验证码\" : time }}\n          </van-button>\n        </template>\n      </van-field>\n\n      <van-field\n        v-model=\"code\"\n        label=\"验证码\"\n        label-width=\"50px\"\n        :rules=\"[\n          { required: true, message: '验证码为必填项哦~' },\n          { pattern: regCode, message: '验证码必须是6位数字哦~' },\n        ]\"\n      />\n    </van-cell-group>\n\n    <div style=\"margin: 20px 40px\">\n      <van-button round block type=\"primary\" native-type=\"submit\">\n        立即登录/注册\n      </van-button>\n    </div>\n  </van-form>\n</template>\n\n<script>\nimport Nav from \"@/components/Nav.vue\";\nimport { reactive, toRefs, ref } from \"vue\";\nimport api from \"@/api/index\";\nimport { Toast } from \"vant\";\nimport { useStore } from \"vuex\";\nimport { useRouter, useRoute } from \"vue-router\";\n\nexport default {\n  components: { Nav },\n  name: \"Login\",\n  setup() {\n    const store = useStore(),\n      router = useRouter(),\n      route = useRoute();\n\n    let formBox = ref(null);\n    let state = reactive({\n      phone: \"\",\n      code: \"\",\n      enable: true,\n      time: \"60s\",\n    });\n\n    // 发送验证码\n    const sendcode = async () => {\n      try {\n        // 校验手机号格式\n        await formBox.value.validate(\"phone\");\n        // 发送请求\n        let { code } = await api.phoneCode(state.phone);\n        if (+code !== 0) {\n          Toast(\"小主，当前网络繁忙，请稍后再试哦~\");\n          return;\n        }\n        // 开启按钮倒计时\n        state.enable = false;\n        state.time = `10s`;\n        let n = 10;\n        let timer = setInterval(() => {\n          n--;\n          if (n === 0) {\n            clearInterval(timer);\n            state.enable = true;\n            return;\n          }\n          state.time = `${n}s`;\n        }, 1000);\n      } catch (err) {}\n    };\n\n    // 表单提交\n    const submit = async () => {\n      let { code, token } = await api.login(state.phone, state.code);\n      if (+code !== 0) {\n        Toast(\"小主，很遗憾，当前登录失败了~\");\n        formBox.value.resetValidation();\n        state.code = \"\";\n        return;\n      }\n      localStorage.setItem(\"token\", token);\n      store.commit(\"changeIsLogin\", true);\n      store.dispatch(\"changeInfoAsync\");\n      store.commit(\"changeStoreList\", null);\n      Toast(\"小主真棒，当前登录成功喽~\");\n\n      // 跳转到指定地址\n      let from = route.query.from;\n      if (from) {\n        router.replace(`/${from}`);\n        return;\n      }\n      router.replace(`/person`);\n    };\n\n    return {\n      ...toRefs(state),\n      formBox,\n      regPhone: /^1\\d{10}$/,\n      regCode: /^\\d{6}$/,\n      sendcode,\n      submit,\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.van-form {\n  margin-top: 30px;\n\n  .form-btn {\n    width: 78px;\n  }\n}\n</style>"],"sourceRoot":""}]}